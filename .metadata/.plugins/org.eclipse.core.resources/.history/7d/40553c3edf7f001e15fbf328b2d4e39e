FROM alpine
RUN apk --no-cache add openjdk16 mc net-tools iputils-ping
RUN mkdir -p /usr/share/loadbalancing-backend
RUN mkdir /usr/share/loadbalancing-backend/transformations
ADD ./lib/* /usr/share/loadbalancing-backend/
ADD ./target/loadbalancing-backend-0.0.1-SNAPSHOT.jar /usr/share/loadbalancing-backend/loadbalancing-backend.jar
WORKDIR /usr/share/loadbalancing-backend
ENV PORT 9090
ENV SERVER_ID Server
ENV FRONTEND_HOST Frontend
ENV FRONTEND_PORT 8080
ENV DEBUG "-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=0.0.0.0:8000"
CMD ["sh", "-c", "java $DEBUG -jar loadbalancing-backend.jar $PORT $ID $FRONTEND_HOST $FRONTEND_PORT"]